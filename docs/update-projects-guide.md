# Руководство по обновлению проектов в базе данных

Это руководство описывает процесс обновления данных проектов в базе данных через скрипты Prisma.

## Предварительные требования

1. Убедитесь, что PostgreSQL запущен и доступен
2. Проверьте, что файл `.env` содержит правильную строку подключения к базе данных:
   ```
   DATABASE_URL=postgresql://postgres:postgres@localhost:5433/homio_new?schema=public
   ```
3. Убедитесь, что все зависимости установлены:
   ```bash
   npm install
   ```

## Получение списка проектов

Перед обновлением проектов полезно получить список существующих проектов, чтобы узнать их ID и текущие данные.

```bash
npm run db:list-projects
```

Этот скрипт выведет основную информацию о первых 10 проектах и общее количество проектов в базе данных.

## Обновление отдельного проекта

Для обновления отдельного проекта используйте файл `prisma/update-projects.ts`:

1. Откройте файл и отредактируйте следующие части:

   - Замените `YOUR_PROJECT_ID` на реальный ID проекта, который вы хотите обновить
   - Измените данные в объекте `data` на нужные значения

2. Запустите скрипт обновления:
   ```bash
   npm run db:update-project
   ```

## Пакетное обновление нескольких проектов

Для обновления нескольких проектов одновременно используйте файл `prisma/batch-update-projects.ts`:

1. Откройте файл и отредактируйте массив `projectUpdates`, заменив:

   - `PROJECT_ID_1`, `PROJECT_ID_2` и т.д. на реальные ID проектов
   - Данные в объектах `data` на нужные значения для каждого проекта

2. Запустите скрипт пакетного обновления:
   ```bash
   npm run db:batch-update-projects
   ```

## Доступные поля для обновления

Основные поля модели Project, которые можно обновить:

- `name`: Название проекта
- `description`: Описание проекта
- `type`: Тип проекта (RESIDENTIAL, COMMERCIAL, MIXED_USE, INFRASTRUCTURE)
- `status`: Статус проекта (DRAFT, ACTIVE, INACTIVE, PLANNING, CONSTRUCTION, COMPLETED)
- `buildingStatus`: Статус строительства (PLANNING, UNDER_CONSTRUCTION, COMPLETED)
- `class`: Класс проекта (STANDARD, COMFORT, BUSINESS, PREMIUM, ELITE, LUXURY)
- `constructionStatus`: Процент готовности (число от 0 до 100)
- `completionDate`: Дата завершения (формат Date)

Для обновления переводов используйте поле `translations` с массивом объектов в формате:

```
translations: [
  {
    language: 'en',
    name: 'English Name',
    description: 'English description'
  },
  {
    language: 'ru',
    name: 'Русское название',
    description: 'Русское описание'
  }
]
```

## Примечания

- Скрипты используют транзакции, поэтому если часть обновлений не удастся выполнить, все изменения будут отменены
- Перед массовым обновлением данных рекомендуется сделать резервную копию базы данных
- Для отладки проблем проверьте вывод консоли, где будут отображаться ошибки и предупреждения
