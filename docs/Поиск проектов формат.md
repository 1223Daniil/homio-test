Поиск проектов формат:

1. Добавил анализ поискового запроса через AI:
```typescript
- Выделение района
- Определение типа недвижимости
- Анализ ценового диапазона
- Выделение требуемых удобств
- Анализ расстояния до пляжа
```

2. Улучшил фильтрацию проектов:
```typescript
- Включил проекты в статусе CONSTRUCTION
- Добавил фильтрацию по району
- Добавил фильтрацию по типу недвижимости
```

3. Улучшил расчет релевантности:
```typescript
- Учет совпадения района (вес 0.3)
- Учет типа недвижимости (вес 0.2)
- Учет расстояния до пляжа (вес 0.2)
- Учет запрошенных удобств (до 0.2)
- Бонус за статус проекта (0.1/0.05)
- Бонус за наличие цен (0.1)
- Бонус за качество данных (до 0.1)
```

4. Добавил отслеживание совпадений:
```typescript
- Список совпавших критериев для каждого проекта
- Подробное логирование результатов поиска
```

Теперь нужно:
1. Исправить типы в `ProjectWithRelations`
2. Обновить обработку результатов в `AIAssistant`
3. Улучшить отображение совпадений в карточке проекта

Начнем с исправления типов?


Хорошо, давайте проанализируем весь флоу и составим план изменений:

1. Проблемы в текущей реализации:
- Выдается только один проект, который не всегда релевантен запросу
- Векторный поиск возвращает ограниченное количество результатов
- Фильтрация проектов слишком строгая
- Конвертация проектов может терять данные
- Анализ AI может быть недостаточно точным

2. План изменений:

А. Улучшение поиска проектов (`route.ts`):
```typescript
1. Увеличить количество возвращаемых проектов в vectorizationService (с 5 до 10-15)
2. Добавить предварительную фильтрацию по базовым критериям (район, тип недвижимости)
3. Улучшить систему ранжирования результатов
4. Добавить фоллбэк на обычный поиск, если векторный не дал результатов
```

Б. Улучшение анализа AI (`route.ts`):
```typescript
1. Улучшить промпт для OpenAI с более четкими критериями анализа
2. Добавить структурированный анализ каждого проекта
3. Улучшить систему скоринга проектов
4. Добавить сравнительный анализ между проектами
```

В. Улучшение конвертации данных (`ai.ts`):
```typescript
1. Переработать функцию convertToAIProject
2. Добавить валидацию всех необходимых полей
3. Улучшить обработку переводов
4. Добавить дополнительные метаданные для более точного отображения
```

Г. Улучшение отображения (`AIAssistant.tsx`):
```typescript
1. Улучшить обработку рекомендаций
2. Добавить сортировку проектов по релевантности
3. Улучшить отображение сравнительного анализа
4. Добавить группировку проектов по релевантности
```

Д. Улучшение типов данных (`project.ts`, `ai.ts`):
```typescript
1. Уточнить типы для более строгой типизации
2. Добавить валидацию данных
3. Улучшить интерфейсы для анализа проектов
4. Добавить утилиты для работы с типами
```

3. Порядок реализации:
1. Сначала улучшим поиск и базовую выдачу проектов
2. Затем улучшим анализ AI и скоринг
3. После этого улучшим конвертацию данных
4. В конце улучшим отображение результатов

4. Ожидаемые результаты:
- Более релевантная выдача проектов
- Качественный анализ каждого проекта
- Понятное сравнение проектов между собой
- Улучшенное отображение результатов

Начнем с улучшения поиска проектов?
