import { HTMLAttributes } from "react";
import { IoBook } from "react-icons/io5";
import { TbBeach } from "react-icons/tb";
import styles from "./MapFilters.module.css";
import { useTranslations } from "next-intl";

interface IProps extends HTMLAttributes<HTMLDivElement> {
  selected: number[];
  onChange?: (selected: number[]) => void;
}

const MapFilters = ({ selected = [], onChange, ...props }: IProps) => {
  const t = useTranslations("UnitDetail.infrastructure");

  // Список меток для фильтров
  const filterLabels = [
    t("map-filters.beaches"),
    t("map-filters.kindergartens"),
    t("map-filters.schools"),
    t("map-filters.clinics"),
    t("map-filters.groceries"),
    t("map-filters.dining"),
    t("map-filters.pharmacy"),
    t("map-filters.gym")
  ];

  // Обработчик клика по фильтру
  const handleFilterClick = (index: number) => {
    if (!onChange) return;

    const newSelected = [...selected];

    // Если фильтр уже выбран - удаляем его, иначе добавляем
    const existingIndex = newSelected.indexOf(index);
    if (existingIndex !== -1) {
      newSelected.splice(existingIndex, 1);
    } else {
      newSelected.push(index);
    }

    onChange(newSelected);
  };

  return (
    <div className={styles.mapFilters} {...props}>
      {filtersIcons.map((Icon, index) => (
        <div
          key={index}
          className={`${styles.filter} ${selected.includes(index) ? styles.filterActive : ""}`}
          onClick={() => handleFilterClick(index)}
          role="button"
          tabIndex={0}
          aria-pressed={selected.includes(index)}
          aria-label={filterLabels[index]}
        >
          {typeof Icon === "function" ? (
            <Icon className={styles.svgSize} />
          ) : (
            Icon
          )}
          <p>{filterLabels[index]}</p>
        </div>
      ))}
    </div>
  );
};

export default MapFilters;

const KindergartenIcon = (
  <svg
    width="16"
    height="16"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M12.4375 15.5358C11.6767 15.5358 11.0625 14.7658 11.0625 13.8125C11.0625 12.8683 11.6767 12.0983 12.4375 12.0983C13.1983 12.0983 13.8125 12.8683 13.8125 13.8125C13.8125 14.7658 13.1983 15.5358 12.4375 15.5358ZM9.00001 8.3125C7.86335 8.3125 6.93751 7.5425 6.93751 6.59833C6.93751 5.645 7.86335 4.875 9.00001 4.875C10.1367 4.875 11.0625 5.645 11.0625 6.59833C11.0625 7.5425 10.1367 8.3125 9.00001 8.3125ZM5.56251 15.5358C4.80168 15.5358 4.18751 14.7658 4.18751 13.8125C4.18751 12.8683 4.80168 12.0983 5.56251 12.0983C6.32335 12.0983 6.93751 12.8683 6.93751 13.8125C6.93751 14.7658 6.32335 15.5358 5.56251 15.5358ZM9.00001 5.5625C9.37585 5.5625 9.68751 5.87417 9.68751 6.25C9.68751 6.62583 9.37585 6.9375 9.00001 6.9375C8.62418 6.9375 8.31251 6.62583 8.31251 6.25C8.31251 5.87417 8.62418 5.5625 9.00001 5.5625ZM15.1875 9C14.8942 9 14.61 9.06417 14.3533 9.18333C13.9133 8.62417 13.3175 8.1475 12.6025 7.78083C13.125 7.0475 13.4367 6.15833 13.4367 5.19583V5.14083C14.4358 4.93 15.1875 4.04083 15.1875 2.96833C15.1875 1.74917 14.1883 0.75 12.9692 0.75C12.3367 0.75 11.75 1.01583 11.365 1.4375C10.6579 0.988503 9.83762 0.750068 9.00001 0.750068C8.16241 0.750068 7.34211 0.988503 6.63501 1.4375C6.25001 1.01583 5.66335 0.75 5.03085 0.75C3.81168 0.75 2.81251 1.74917 2.81251 2.96833C2.81251 4.03167 3.56418 4.92083 4.55418 5.14083V5.19583C4.55418 6.15833 4.87501 7.05667 5.38835 7.78083C4.68251 8.1475 4.08668 8.62417 3.64668 9.18333C3.33342 9.04222 2.98976 8.98197 2.64718 9.0081C2.3046 9.03422 1.97406 9.1459 1.68582 9.33288C1.39759 9.51987 1.16088 9.77619 0.997389 10.0784C0.833894 10.3806 0.748838 10.7189 0.750012 11.0625C0.750012 12.2083 1.66668 13.125 2.81251 13.125H2.86751C2.83085 13.345 2.81251 13.5833 2.81251 13.8125C2.81251 15.71 4.04085 17.25 5.56251 17.25C6.48835 17.25 7.30418 16.6725 7.80835 15.7925C8.19335 15.8475 8.58751 15.875 9.00001 15.875C9.41251 15.875 9.80668 15.8475 10.1917 15.7925C10.6958 16.6725 11.5117 17.25 12.4375 17.25C13.9592 17.25 15.1875 15.71 15.1875 13.8125C15.1875 13.5833 15.1692 13.345 15.1325 13.125H15.1875C16.3333 13.125 17.25 12.2083 17.25 11.0625C17.25 9.91667 16.3333 9 15.1875 9Z"
      fill="currentColor"
    />
  </svg>
);

const ClinicsIcon = (
  <svg
    width="16"
    height="16"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M5.44444 0C5.17923 0 4.92487 0.105357 4.73734 0.292893C4.5498 0.48043 4.44444 0.734784 4.44444 1V4.44444H1C0.734784 4.44444 0.48043 4.5498 0.292893 4.73734C0.105357 4.92487 0 5.17923 0 5.44444V10.5556C0 10.8208 0.105357 11.0751 0.292893 11.2627C0.48043 11.4502 0.734784 11.5556 1 11.5556H4.44444V15C4.44444 15.2652 4.5498 15.5196 4.73734 15.7071C4.92487 15.8946 5.17923 16 5.44444 16H10.5556C10.8208 16 11.0751 15.8946 11.2627 15.7071C11.4502 15.5196 11.5556 15.2652 11.5556 15V11.5556H15C15.2652 11.5556 15.5196 11.4502 15.7071 11.2627C15.8946 11.0751 16 10.8208 16 10.5556V5.44444C16 5.17923 15.8946 4.92487 15.7071 4.73734C15.5196 4.5498 15.2652 4.44444 15 4.44444H11.5556V1C11.5556 0.734784 11.4502 0.48043 11.2627 0.292893C11.0751 0.105357 10.8208 0 10.5556 0H5.44444Z"
      fill="currentColor"
    />
  </svg>
);

const GroceriesIcon = (
  <svg
    width="18"
    height="18"
    viewBox="0 0 18 18"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M11.4429 0.329903C11.6059 0.24099 11.7946 0.226332 11.9675 0.28915C12.1405 0.351968 12.2834 0.487122 12.3651 0.664903L14.3826 5.0669C15.6229 5.1709 16.4011 5.4369 16.9035 6.1139C17.7285 7.2279 17.3994 8.9039 16.7412 12.2569L16.348 14.2569C15.9016 16.5299 15.6788 17.6659 14.9226 18.3329C14.1663 18.9999 13.1011 18.9999 10.9708 18.9999H7.02914C4.89881 18.9999 3.83364 18.9999 3.07831 18.3329C2.32114 17.6659 2.09747 16.5299 1.65197 14.2569L1.25872 12.2569C0.600556 8.9039 0.270556 7.2279 1.09647 6.1139C1.59881 5.4359 2.37706 5.1709 3.61731 5.0669L5.63489 0.664903C5.71718 0.488533 5.86004 0.354794 6.03233 0.29283C6.20462 0.230866 6.39237 0.2457 6.55468 0.334099C6.71698 0.422498 6.84069 0.577297 6.89882 0.764761C6.95696 0.952225 6.94482 1.15716 6.86506 1.3349L5.18297 5.0049C5.62572 4.9999 6.10881 4.9999 6.63681 4.9999H11.3631C11.8911 4.9999 12.3742 4.9999 12.817 5.0049L11.1349 1.3349C11.0535 1.15694 11.0401 0.950978 11.0979 0.762318C11.1557 0.573658 11.2798 0.418755 11.4429 0.329903ZM4.64581 9.9999C4.64581 9.80099 4.71824 9.61023 4.84717 9.46957C4.9761 9.32892 5.15097 9.2499 5.33331 9.2499H12.6666C12.849 9.2499 13.0238 9.32892 13.1528 9.46957C13.2817 9.61023 13.3541 9.80099 13.3541 9.9999C13.3541 10.1988 13.2817 10.3896 13.1528 10.5302C13.0238 10.6709 12.849 10.7499 12.6666 10.7499H5.33331C5.15097 10.7499 4.9761 10.6709 4.84717 10.5302C4.71824 10.3896 4.64581 10.1988 4.64581 9.9999ZM7.16664 12.2499C6.9843 12.2499 6.80944 12.3289 6.6805 12.4696C6.55157 12.6102 6.47914 12.801 6.47914 12.9999C6.47914 13.1988 6.55157 13.3896 6.6805 13.5302C6.80944 13.6709 6.9843 13.7499 7.16664 13.7499H10.8333C11.0156 13.7499 11.1905 13.6709 11.3194 13.5302C11.4484 13.3896 11.5208 13.1988 11.5208 12.9999C11.5208 12.801 11.4484 12.6102 11.3194 12.4696C11.1905 12.3289 11.0156 12.2499 10.8333 12.2499H7.16664Z"
      fill="currentColor"
    />
  </svg>
);

const DiningIcon = (
  <svg
    width="13"
    height="16"
    viewBox="0 0 13 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M12.5 0C12.7245 3.23106e-05 12.9412 0.0899562 13.109 0.252715C13.2768 0.415475 13.384 0.639749 13.4102 0.883L13.4166 1V17C13.4164 17.2549 13.3269 17.5 13.1665 17.6854C13.0061 17.8707 12.7869 17.9822 12.5537 17.9972C12.3205 18.0121 12.0908 17.9293 11.9116 17.7657C11.7325 17.6021 11.6173 17.3701 11.5897 17.117L11.5833 17V12H10.6666C10.4421 12 10.2254 11.91 10.0576 11.7473C9.88986 11.5845 9.78267 11.3603 9.7564 11.117L9.74998 11V5C9.74998 2.79 11.125 0 12.5 0ZM6.99998 0C7.2245 3.23106e-05 7.44121 0.0899562 7.60899 0.252715C7.77677 0.415475 7.88396 0.639749 7.91023 0.883L7.91665 1V6C7.91654 6.88687 7.64639 7.74858 7.14864 8.44978C6.65088 9.15098 5.95372 9.65195 5.16665 9.874V17C5.16639 17.2549 5.07692 17.5 4.91654 17.6854C4.75615 17.8707 4.53694 17.9822 4.3037 17.9972C4.07046 18.0121 3.8408 17.9293 3.66163 17.7657C3.48247 17.6021 3.36732 17.3701 3.33973 17.117L3.33331 17V9.874C2.57748 9.66084 1.90369 9.19019 1.40993 8.53051C0.916174 7.87083 0.628202 7.05652 0.587896 6.206L0.583313 6V1C0.583572 0.74512 0.673035 0.499968 0.833424 0.314632C0.993812 0.129296 1.21302 0.017765 1.44626 0.00282788C1.6795 -0.0121092 1.90916 0.0706746 2.08833 0.234265C2.26749 0.397855 2.38263 0.629904 2.41023 0.883L2.41665 1V6C2.41665 6.35106 2.50137 6.69594 2.66228 6.99997C2.82319 7.304 3.05462 7.55647 3.33331 7.732V1C3.33357 0.74512 3.42304 0.499968 3.58342 0.314632C3.74381 0.129296 3.96302 0.017765 4.19626 0.00282788C4.4295 -0.0121092 4.65916 0.0706746 4.83833 0.234265C5.01749 0.397855 5.13263 0.629904 5.16023 0.883L5.16665 1L5.16756 7.732C5.42337 7.57069 5.63965 7.34433 5.79798 7.07218C5.95631 6.80004 6.052 6.49018 6.0769 6.169L6.08331 6V1C6.08331 0.734784 6.17989 0.48043 6.3518 0.292893C6.52371 0.105357 6.75686 0 6.99998 0Z"
      fill="currentColor"
    />
  </svg>
);

const PharmacyIcon = (
  <svg
    width="20"
    height="26"
    viewBox="0 0 20 26"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M10.3898 7.95825C10.3636 7.22034 10.3847 6.43888 10.6446 5.82838C10.7816 5.50754 10.9792 5.24813 11.2652 5.06434C11.5526 4.88009 11.9651 4.74992 12.5682 4.74992C13.2443 4.74992 13.8076 4.99559 14.2109 5.25134C14.4112 5.37875 14.5675 5.50571 14.6724 5.59967C14.7215 5.64366 14.7689 5.68953 14.8145 5.73717L14.8191 5.74175V5.74221C14.8591 5.78723 14.9075 5.82394 14.9617 5.85024C15.0158 5.87654 15.0746 5.89192 15.1347 5.89549C15.1948 5.89907 15.255 5.89077 15.3119 5.87108C15.3688 5.85138 15.4213 5.82068 15.4663 5.78071C15.5113 5.74074 15.548 5.6923 15.5743 5.63815C15.6006 5.584 15.616 5.5252 15.6196 5.4651C15.6231 5.40501 15.6148 5.34479 15.5951 5.28791C15.5754 5.23102 15.5447 5.17857 15.5048 5.13354L15.1679 5.43146C15.5048 5.13354 15.5039 5.13263 15.5039 5.13263L15.502 5.13034L15.4974 5.12575C15.4794 5.10538 15.4607 5.08551 15.4415 5.06617C15.3907 5.01491 15.3382 4.96523 15.2843 4.91721C15.1026 4.75491 14.9079 4.60775 14.7022 4.47721C14.2026 4.16142 13.4693 3.83325 12.5682 3.83325C11.8321 3.83325 11.2377 3.99321 10.7702 4.29296C10.3013 4.59409 9.99561 5.01254 9.80127 5.46904C9.46302 6.26334 9.44652 7.20979 9.47219 7.95825H7.04165C6.78819 7.95825 6.58056 8.1645 6.60944 8.41567C6.89131 10.8815 9.43277 12.8354 12.5944 12.9898V16.6666H13.511V12.9843C14.274 12.9389 15.0261 12.7814 15.7431 12.5168C15.7477 12.5695 15.75 12.6236 15.75 12.6805C15.75 13.0297 15.4644 13.4477 14.8787 13.8107C14.5784 13.9943 14.2548 14.1367 13.9166 14.2342V15.1811C14.4267 15.0628 14.9143 14.8632 15.3609 14.5899C16.0355 14.1733 16.6666 13.5146 16.6666 12.6809C16.6666 12.493 16.6492 12.3074 16.6103 12.1273C18.1535 11.3004 19.2136 9.95842 19.3905 8.41613C19.4194 8.16496 19.2113 7.95871 18.9583 7.95871H10.3898V7.95825Z"
      fill="currentColor"
    />
    <path
      d="M15.75 19.8749C15.75 20.4088 15.585 20.8777 15.2829 21.2499H16.6666V22.1666H9.33331V21.2499H12.5944V19.4166H13.511V21.2105C13.8786 21.1504 14.1692 21.0253 14.3782 20.8608C14.6646 20.6362 14.8333 20.3126 14.8333 19.8749C14.8333 19.4372 14.6646 19.1141 14.3782 18.889C14.0803 18.6543 13.6164 18.4994 13 18.4994C12.3047 18.4994 11.5333 18.4449 10.9233 18.174C10.6098 18.0347 10.3206 17.8303 10.1106 17.531C9.8989 17.2285 9.79165 16.8613 9.79165 16.4374C9.79165 16.0134 9.8989 15.6463 10.1106 15.3438C10.3206 15.0445 10.6102 14.8401 10.9233 14.7008C11.2716 14.5458 11.6736 14.4615 12.0833 14.418V15.3406C11.7817 15.3786 11.5141 15.4414 11.2954 15.5386C11.0933 15.6284 10.9531 15.7393 10.8619 15.8695C10.7729 15.9965 10.7083 16.1738 10.7083 16.4374C10.7083 16.7009 10.7725 16.8783 10.8619 17.0053C10.9531 17.1354 11.0933 17.2463 11.2954 17.3362C11.7171 17.5236 12.3203 17.5832 13 17.5832C13.7581 17.5832 14.441 17.7725 14.9447 18.1681C15.4603 18.5732 15.75 19.1668 15.75 19.8749Z"
      fill="currentColor"
    />
  </svg>
);

const GymIcon = (
  <svg
    width="22"
    height="12"
    viewBox="0 0 22 12"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M21.2667 5.2667V6.73337H19.8V9.6667H18.3333V11.1334H16.1333V6.73337H5.86667V11.1334H3.66667V9.6667H2.2V6.73337H0.733337V5.2667H2.2V2.33337H3.66667V0.866699H5.86667V5.2667H16.1333V0.866699H18.3333V2.33337H19.8V5.2667H21.2667Z"
      fill="currentColor"
    />
  </svg>
);

const filtersIcons = [
  TbBeach,
  KindergartenIcon,
  IoBook,
  ClinicsIcon,
  GroceriesIcon,
  DiningIcon,
  PharmacyIcon,
  GymIcon
];
